Game.Play=function(t){},Game.Play.prototype={create:function(){this.game.world.setBounds(0,-1e5,w,h+1e5),this.cursor=this.game.input.keyboard.createCursorKeys(),this.wolks=game.add.group(),this.wolks.createMultiple(6,"wolk"),this.wolks.setAll("outOfBoundsKill",!0),score>best_score&&(best_score=score),score=0,this.platforms=game.add.group(),this.platforms.createMultiple(15,"platform"),this.platforms.setAll("body.immovable",!0),this.platforms.setAll("body.allowCollision.down",!1),this.platforms.setAll("body.allowCollision.right",!1),this.platforms.setAll("body.allowCollision.left",!1),this.hearts=game.add.group(),this.hearts.createMultiple(3,"heart"),this.spikes=game.add.group(),this.spikes.createMultiple(5,"spike"),this.emitter=game.add.emitter(0,0,100),this.emitter.x=-100,this.emitter.on=!1,this.emitter.makeParticles("star2"),this.emitter.gravity=10,this.emitter.start(!1,1e3,15,0),this.emitter.width=60,this.mario=this.game.add.sprite(w/2+100,h-200,"mario"),this.mario.body.gravity.y=12,this.mario.anchor.setTo(.5,1),this.ground=this.game.add.sprite(0,h/3+55,"ground"),this.ground.scale.setTo(10,1),this.ground.body.immovable=!0,this.ground.outOfBoundsKill=!0,this.score_label=game.add.text(10,10,"0",{font:"28px Arial",fill:"#fff"}),this.jump_s=game.add.audio("jump"),this.heart_s=game.add.audio("heart"),this.hit_s=game.add.audio("hit"),this.music_s=game.add.audio("music"),sound&&this.music_s.play("",0,.2,!0),this.maxX=h/2-20,this.next_platform=10,this.next_wolk=50,this.took_heart=!1,this.count_update=0,this.init_level()},update:function(){this.mario.alive&&(this.ground.alive&&game.physics.collide(this.mario,this.ground),game.physics.collide(this.mario,this.platforms),game.physics.overlap(this.mario,this.hearts,this.take_heart,null,this),game.physics.overlap(this.mario,this.spikes,this.take_spike,null,this)),this.mario.body.y<this.game.camera.y+h/2&&(this.move_screen_up(),this.generate_level()),20==this.count_update?(this.count_update=0,this.platforms.forEachAlive(this.update_platform,this),this.hearts.forEachAlive(this.update_heart,this),this.spikes.forEachAlive(this.update_spike,this)):this.count_update+=1,this.mario_move()},init_level:function(){this.add_platform(h-150,100),this.add_platform(h-300,200),this.add_platform(h-450,300),this.add_platform(h-550,300),this.add_wolk(h-300),this.add_wolk(h-500)},generate_level:function(){if(this.next_platform<-this.game.camera.y){if(score<250)var t=[1,1,1,1,2,2,2,3,5,5];else if(score<500)var t=[1,1,2,2,2,3,3,4,4,5];else if(score<1e3)var t=[1,2,2,3,3,3,4,4,4,5];else if(score<2e3)var t=[1,2,3,3,3,4,4,4,4,5];else if(score<3e3)var t=[2,3,3,3,4,4,4,4,4,5];else var t=[2,3,3,4,4,4,4,4,4,4];var i=t[rand(t.length)],e=this.game.camera.y-30;this.next_platform+=rand(80)+100,1==i?this.add_platform_double(e):2==i?this.add_platform(e):3==i?this.add_platform_moving(e):4==i?(rand(3)>0?this.add_platform_moving(e):this.add_platform_double(e),this.add_platform_spike(e-150),this.next_platform+=150):5==i&&this.add_platform_heart(e)}this.next_wolk<-this.game.camera.y&&(this.add_wolk(this.game.camera.y-70),this.next_wolk+=100+rand(200))},move_screen_up:function(){var t=this.game.camera.y+Math.floor(h/2)-this.mario.body.y;this.game.camera.y-=t,this.score_label.y=this.game.camera.y+10,score=-Math.floor(this.game.camera.y/10),this.score_label.content=score},mario_move:function(){if(this.mario.body.y>this.game.camera.y+h+200)return this.music_s.stop(),void game.state.start("Dead");if(this.mario.x<20?this.mario.x=20:this.mario.x>w-20&&(this.mario.x=w-20),this.mario.body.touching.down&&1==this.mario.scale.y){if(sound&&this.jump_s.play("",0,.15,!1),1==this.mario.scale.x)var t=1.3;else var t=-1.3;var i=game.add.tween(this.mario.scale).to({y:.7,x:t},150,Phaser.Easing.Linear.None).start();i.onComplete.add(function(){1==this.mario.scale.x?this.mario.scale.setTo(1,1):this.mario.scale.setTo(-1,1),this.mario.body.velocity.y=-500},this)}this.mario.body.velocity.x=0;var e=game.input.activePointer.isDown&&game.input.activePointer.x>w/2,a=game.input.activePointer.isDown&&game.input.activePointer.x<w/2;(this.cursor.left.isDown||a)&&this.mario.alive?(this.mario.frame=0,this.mario.body.velocity.x=-300,1==this.mario.scale.x&&this.mario.scale.setTo(-1,1)):(this.cursor.right.isDown||e)&&this.mario.alive?(this.mario.frame=0,this.mario.body.velocity.x=300,-1==this.mario.scale.x&&this.mario.scale.setTo(1,1)):this.mario.frame=1,this.mario.body.velocity.y>-200&&(this.took_heart=!1,this.emitter.on=!1),this.emitter.x=this.mario.x,this.emitter.y=this.mario.y-15},add_platform:function(t,i){var e=this.platforms.getFirstExists(!1);return e?(i="undefined"!=typeof i?i:rand(w-e.width-10)+e.width/2+5,e.reset(i,t),e.anchor.setTo(.5,.5),e.body.velocity.x=0,e):void console.log("plat")},add_platform_double:function(t){this.add_platform(t),this.add_platform(t)},add_platform_heart:function(t){var i=this.add_platform(t),e=this.hearts.getFirstExists(!1);e&&(e.anchor.setTo(.5,.5),e.reset(i.x,t-29))},add_platform_spike:function(t){var i=this.add_platform(t);this.add_spike(i.x,i.y+18)},add_platform_moving:function(t){var i=this.add_platform(t);0==rand(2)?i.body.velocity.x=-120:i.body.velocity.x=120},add_wolk:function(t){var i=this.wolks.getFirstExists(!1);i?(i.reset(rand(w)-i.width,t),1==rand(2)?i.body.velocity.x=8:i.body.velocity.x=-8):console.log("wolk")},add_spike:function(t,i){var e=this.spikes.getFirstExists(!1);e?(e.body.setSize(e.width-6,e.height-6,0,0),e.anchor.setTo(.5,.5),e.reset(t,i)):console.log("spike")},update_platform:function(t){t.x+t.width/2>=w&&t.body.velocity.x>0?t.body.velocity.x=-120:t.x-t.width/2<=0&&t.body.velocity.x<0&&(t.body.velocity.x=120),t.y-t.height>this.game.camera.y+h&&t.kill()},update_heart:function(t){t.y-t.height>this.game.camera.y+t&&t.kill()},update_spike:function(t){t.y-t.height>this.game.camera.y+h&&t.kill()},take_heart:function(t,i){i.kill(),sound&&this.heart_s.play("",0,.2,!1),this.emitter.on=!0,this.mario.body.velocity.y=-750,this.took_heart=!0},take_spike:function(t,i){this.took_heart||(sound&&this.hit_s.play("",0,.4,!1),this.mario.alive=!1,this.mario.body.velocity.y=-300)},shutdown:function(){game.world.removeAll()}};